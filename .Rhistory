install.packages("rvest")
url <- "https://en.wikipedia.org/wiki/Roy_Williams_(coach)#Head_coaching_record"
library(tidyverse)
library(rvest)
rw <- url %>% html() %>% html_nodes(xpath = '//*[@id="mw-content-text"]/table[3]') %>% html_table()
rw <- url %>% read_html() %>%
html_nodes(xpath = '//*[@id="mw-content-text"]/table[3]') %>%
html_table()
rw <- url %>% read_html() %>%
html_nodes(xpath = '//*[@id="mw-content-text"]/table[3]', fill = TRUE) %>%
html_table()
rw <- url %>% read_html() %>%
html_nodes(xpath = '//*[@id="mw-content-text"]/table[3]') %>%
html_table(fill = TRUE)
rw
str(rw)
rw$Overall
rw$" Overall"
rw[[1]]$Overall
rw_records <- rw[[1]]$Overall
head(rw_records)
rw_year <- rw[[1]]$Season
rw_year
df_rw <- data.frame(rw_year, rw_records)
head(df_rw)
nchar(df_rw)
nchar(df_rw[1,1])
nchar(df_rw$rw_year)
nchar(df_rw$rw_year[[1]])
df_year[[1]]
rw_year[[1]]
nchar(rw_year[[1]])
str(df_rw)
df_rw <- tbl(rw_year, rw_records)
df_rw <- tibble(rw_year, rw_records)
str(df_rw)
df_rw <- df_rw %>% filter(nchar(rw_year) < 10)
head(df_rw)
library(attutilr)
headtail(dr_rw)
headtail(df_rw)
df_rw <- df_rw %>% filter(nchar(rw_records) < 6)
df_rw <- tibble(rw_year, rw_records)
df_rw <- df_rw %>% filter(nchar(rw_records) < 6)
dim(df_rw)
headtail(df_rw)
grepl(df_rw$rw_records[1],"-")
df_rw$rw_records[1]
grepl(df_rw$rw_records[1],"–")
?grepl
grepl("–", df_rw$rw_records[1])
grep("–", df_rw$rw_records[1])
?strsplit
df_rw <- df_rw %>% mutate(win = strsplit(rw_records, "–")[1], loss = strsplit(rw_records, "–")[2])
strsplit(df_rw$rw_records[1])[1]
strsplit(df_rw$rw_records[1], "–")[1]
df_rw <- tibble(rw_year, rw_records)
df_rw <- df_rw %>% filter(nchar(rw_records) < 6)
df_rw <- df_rw %>% mutate(win = strsplit(rw_records, "–")[1], loss = strsplit(rw_records, "–")[2])
library(stringr)
?str_split
df_rw <- tibble(rw_year, rw_records)
df_rw <- df_rw %>% filter(nchar(rw_records) < 6)
df_rw <- df_rw %>% mutate(win = str_split("–", rw_records)[1], loss = str_split("–", rw_records)[2])
str_split("–", df_rw$rw_records[1])
df_rw <- tibble(rw_year, rw_records)
df_rw <- df_rw %>% filter(nchar(rw_records) < 6)
str_split("–", df_rw$rw_records[1])
str_split("–", "10-20")
df_rw <- tibble(rw_year, rw_records)
df_rw <- df_rw %>% filter(nchar(rw_records) < 6)
df_rw <- df_rw %>% mutate(win = str_split(rw_records, "–", )[1], loss = str_split( rw_records, "–")[2])
str_split(10-20", "–")
str_split("10–20", "–")
df_rw <- df_rw %>% mutate(win = str_split(rw_records, "–")[1], loss = str_split( rw_records, "–")[2])
df_rw <- tibble(rw_year, rw_records)
df_rw <- df_rw %>% filter(nchar(rw_records) < 6)
df_rw <- df_rw %>% mutate(win = str_split(rw_records, "–")[1], loss = str_split( rw_records, "–")[2])
df_rw <- tibble(rw_year, rw_records)
df_rw <- df_rw %>% filter(nchar(rw_records) < 6)
headtail(df_rw)
df_rw <- tibble(rw_year, rw_records)
df_rw <- df_rw %>% filter(nchar(rw_records) < 6)
df_rw <- df_rw %>% mutate(win = str_split(rw_records, "–")[[1]], loss = str_split( rw_records, "–")[[2]])
df_rw <- tibble(rw_year, rw_records)
df_rw <- df_rw %>% filter(nchar(rw_records) < 6)
df_rw <- df_rw %>% mutate(win = str_split(rw_records, "–")[[1]][[1]], loss = str_split( rw_records, "–")[[1]][[2]])
headtail(df_rw)
str_split(df_rw$rw_records, "–")
str(df_rw)
?split
?unite
?separate
df_rw <- tibble(rw_year, rw_records)
df_rw <- df_rw %>% filter(nchar(rw_records) < 6)
#df_rw <- df_rw %>% mutate(win = str_split(rw_records, "–")[[1]][[1]], loss = str_split( rw_records, "–")[[1]][[2]])
df_rw <- df_rw %>% separate(rw_records, c("win", "loss"))
headtail(df_Rw)
headtail(df_rw)
sum(df_rw$win)
df_rw <- df_rw %>% separate(rw_records, c("win", "loss"), convert = TRUE)
rw_year <- rw[[1]]$Season
df_rw <- tibble(rw_year, rw_records)
df_rw <- df_rw %>% filter(nchar(rw_records) < 6)
df_rw <- df_rw %>% separate(rw_records, c("win", "loss"), convert = TRUE)
sum(df_rw$win)
str(df_rw$win)
str(df_rw)
df_rw <- df_rw %>% mutate(career_yr = row_index())
?row_index
?index_row
df_rw <- df_rw %>% mutate(career_yr = row_number())
headtail(df_rw)
str(df_rw)
df_rw %>% ggplot(aes(x = carrer_yr, y = win)) + geom_point()
df_rw %>% ggplot(aes(x = career_yr, y = win)) + geom_point()
df_rw <- df_rw %>% filter(nchar(rw_records) < 6)
df_rw <- df_rw %>% separate(rw_records, c("win", "loss"), convert = TRUE)
df_rw <- df_rw %>% mutate(win_cum = cumsum(win), career_yr = row_number())
df_rw %>% ggplot(aes(x = career_yr, y = win)) + geom_point()
df_rw %>% ggplot(aes(x = career_yr, y = win_cum)) + geom_point()
library(tidyverse)
library(rvest)
source("utils.R")
#---------------
# read data
#---------------
coaches <- read.csv("input_data_table.csv", header = TRUE, as.is = TRUE, quote = "")
coaches$career_records <- apply(coaches, 1, grab_records)
# why not working?
#coaches <- src %>% mutate(career_records = apply(coaches, 1, grab_records))
setNames(coaches$career_records, coaches$Coach)
# latest wins
coaches$latest_wins <- coaches$career_records %>% map_int(function(x) x$win_cum[nrow(x)])
#---------------
# total wins
#---------------
coaches %>% ggplot(aes(x = reorder(Coach, latest_wins), y = latest_wins)) + geom_bar(stat = "identity") + coord_flip() + theme_bw()
#---------------
# win by career year
#---------------
#df_career_records <- bind_rows(coaches$career_records, .id = "Coach")
#df_career_records <- rbindlist(coaches$career_records, idcol = "Coach")
df_career_records <- coaches %>% unnest() %>% select(Coach, career_yr, win_cum)
df_career_records$type <- ifelse(df_career_records$Coach %in% c("Dean Smith", "Roy Williams", "Coach K"), TRUE, FALSE)
df_career_records %>% ggplot(aes(x = career_yr, y = win_cum)) + geom_point(aes(group = Coach, colour = type)) + geom_line(aes(group = Coach, colour = type)) + theme_bw() + stat_smooth()
